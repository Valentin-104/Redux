---
title: Generating Images Using Karlo API
date: '2024-01-08'
tags: ['React', 'JavaScript', 'Next.js', 'project', 'Gemini']
draft: false
summary: Karlo APIë¥¼ í™œìš©í•œ ì´ë¯¸ì§€ ìƒì„±
---

*DALLÂ·E* ì²˜ëŸ¼ í”„ë¡¬í”„íŠ¸ë¥¼ ì œì‹œí•˜ë©´ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê³  ì‹¶ì—ˆë‹¤. ì°¾ì•„ë³´ë‹ˆ ì¹´ì¹´ì˜¤ ì¸ê³µì§€ëŠ¥ API ì¤‘ì— [Karlo](https://developers.kakao.com/product/karlo)ë¼ëŠ” ë¹„ìŠ·í•œ AI ëª¨ë¸ì´ ìˆì—ˆë‹¤. 
ë¬¸ì„œë¥¼ ë³´ë©´ì„œ ì§„í–‰í–ˆë‹¤.

1. ì¹´ì¹´ì˜¤ API URLê³¼ keyë¥¼ ë°›ì•„ `.env.local`ì— ì ëŠ”ë‹¤.
2. `lib/utils.ts`ì—ì„œ ì´ë¥¼ ì´ìš©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“ ë‹¤. 

    ```ts:lib/utils.ts
    export async function generateImage(prompt: string, samples: number) {
      const response = await fetch(process.env.KAKAO_API_URL as string, {
        method: 'POST',
        headers: {
          Authorization: `KakaoAK ${process.env.KAKAO_API_KEY as string}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          prompt,
          samples, // ìƒì„±í•  ì´ë¯¸ì§€ ê°œìˆ˜
        }),
      });
    
      const data = await response.json();
    
      return data;
    }
    ```
3. ì„œë²„ ì•¡ì…˜ì„ ì‚¬ìš©í•  ê²ƒì´ê¸° ë•Œë¬¸ì— `app` í´ë” ì•ˆì— `actions.ts` íŒŒì¼ì„ ë§Œë“¤ê³ , ì—¬ê¸°ì— ì„œë²„ ì•¡ì…˜ì„ ì‘ì„±í•œë‹¤.
   
   ```ts:app/actions.ts
   'use server';

    import { image } from '@/lib/types';
    import { generateImage } from '../lib/utils';

    export async function getImageUrls(formData: FormData) {
      try {
          const prompt = formData.get('prompt') as string;
          const sampleAmount = formData.get('amount') as string;
  
          const imageData = await generateImage(prompt, parseInt(sampleAmount));
  
          return { imageUrls: imageData.images as image[] };
      } catch (error) {
          throw new Error('Failed to get image url');
      }
    } 
   ```  
4. ì„œë²„ ì•¡ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ì§€ urlì„ ì‘ë‹µìœ¼ë¡œ ë°›ê³ , `photos` ìƒíƒœë¥¼ ë³€ê²½í•˜ì—¬ `Image` ì»´í¬ë„ŒíŠ¸ì˜ `src`ë¡œ ì „ë‹¬í•œë‹¤.

   ```tsx:components/photos.tsx
   'use client';
   
   import { Input } from '@/components/ui/input';
   import { getImageUrls } from '@/app/actions';
   import { useState } from 'react';
   import { image } from '@/lib/types';
   import SubmitButton from './submit-button';
   import { toast } from 'sonner';
   import SelectOptions from './select-options';
   import GeneratedPhotos from './generated-photos';
   
   export default function Photos() {
     const [photos, setPhotos] = useState<image[]>([]);
     const [amount, setAmount] = useState<string>('1');
   
     const formAction = async (formData: FormData) => {
       const result = await getImageUrls(formData);
   
       if (result) {
         let message =
           amount === '1'
             ? 'ğŸ‰ New photo is showing up...'
             : 'ğŸ‰ New photos are showing up...';
   
         toast(message);
         setPhotos(result.imageUrls);
       }
     };
   
     return (
       <div>
         <form className='space-y-3' action={formAction}>
           <Input
             name='prompt'
             id='prompt'
             type='text'
             placeholder='An armchair in the shape of an avocado'
             className='focus-visible:ring-0'
             required
             autoFocus
           />
           <section className='flex items-start gap-x-5 justify-end'>
             <SelectOptions amount={amount} setAmount={setAmount} />
             <SubmitButton
               variant='premium'
               className='w-32'
               text='Generate'
               size='lg'
             />
            {/* amount ìƒíƒœë¥¼ formDataë¡œ ë°›ê¸° ìœ„í•´ ì¶”ê°€ */}
             <Input type='hidden' name='amount' id='amount' value={amount} /> 
           </section>
         </form>
   
         <GeneratedPhotos photos={photos} />
       </div>
     );
   }
   ```