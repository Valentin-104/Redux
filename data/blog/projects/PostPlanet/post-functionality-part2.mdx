---
title: Post Functionality - Part. 2
date: '2024-04-11'
tags: ['project', 'Next.js', 'server actions', 'PostPlanet']
draft: false
summary: ì„œë²„ ì•¡ì…˜ì„ í™œìš©í•œ í…ìŠ¤íŠ¸ & ì´ë¯¸ì§€ ê²Œì‹œ
---

- ë§Œì•½ ì„œë²„ ì•¡ì…˜ì´ ì„±ê³µí•˜ë©´ [revalidatePath](https://nextjs.org/docs/app/api-reference/functions/revalidatePath#revalidating-all-data)ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ë°ì´í„°ë¥¼ revalidateí•˜ì—¬, ì‹¤ì‹œê°„ìœ¼ë¡œ UIê°€ ë³€ê²½ë  ìˆ˜ ìˆë„ë¡ í•˜ì˜€ë‹¤.

    ```ts:actions/post.actions.ts
    'use server';

    import db from '@/lib/db';
    import { revalidatePath } from 'next/cache';

    export async function createPost(
      prevState: {
        message: string;
      },
      formData: FormData
    ) {
      const image = formData.get('fileUrl') as string;
      let text = formData.get('text') as string;
      text = text.trim();
      const userId = formData.get('userId') as string;

      try {
        await db.post.create({
          data: {
            text,
            image,
            author: {
              connect: {
                id: userId,
              },
            },
          },
        });

        revalidatePath('/', 'layout');

        return {
          message: 'Success',
        };
      } catch (error) {
        return {
          message: 'Failed to post ğŸ˜¢',
        };
      }
    }
    ```