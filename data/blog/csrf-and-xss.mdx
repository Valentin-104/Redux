---
title: CSRF & XSS
date: '2023-11-30'
tags: ['Interview']
draft: false
summary: CSRF(Cross-Site Request Forgery)와 XSS(Cross-Site Scripting)에 대하여
---

CSRF(Cross-Site Request Forgery)는 공격자가 사용자의 권한을 이용하여 원치 않는 행동을 수행하도록 유도하는 보안 취약점이다. 이 공격은 사용자가 이미 인증되어 있는 상태에서, 공격자의 의도에 따라 웹 애플리케이션에서 정의한 특정 동작을 수행하게 한다.

CSRF를 막기 위한 주요 방법은 다음과 같다:

1. **CSRF 토큰 사용:**
   
    웹 애플리케이션에서는 사용자의 세션에 대한 정보를 기반으로 한 특별한 CSRF 토큰을 생성하고, 이를 모든 폼 요청이나 중요한 HTTP 요청에 포함시킨다. 공격자가 토큰을 알지 못하면 해당 요청은 서버에서 거부된다.

2. **SameSite 쿠키 속성 사용:**
   
    SameSite 쿠키 속성을 사용하여 쿠키가 동일 출처에서의 요청에만 전송되도록 설정할 수 있다. SameSite=None; Secure와 같은 설정은 안전한(HTTPS) 연결에서만 쿠키가 전송되도록 하는데 도움이 된다.

3. **Referer 검증:**
   
    서버에서 HTTP Referer 헤더를 검증하여 요청이 유효한 출처에서 왔는지 확인할 수 있다. 하지만 이 방법은 항상 신뢰할 수 없기 때문에 CSRF 토큰과 함께 사용하는 것이 좋다.

4. **Double Submit Cookie 패턴:**
   
    서버에는 쿠키에 저장된 값과 요청의 본문에 포함된 값이 일치하는지 확인하는 Double Submit Cookie 패턴을 사용할 수 있다. 이 방법은 악의적인 웹 사이트에서 쿠키에 접근할 수 있더라도, 본문에 해당하는 값을 알아내기 어렵게 만든다.

5. **HTTP 메서드 검증:**
   
    웹 애플리케이션에서는 중요한 동작을 수행하는 요청에 대해서는 GET 요청이 아닌 POST, PUT, DELETE와 같은 안전하지 않은 HTTP 메서드를 사용하도록 하여 CSRF 공격의 영향을 최소화할 수 있다.

이러한 방법들을 조합하여 사용하면 CSRF 공격을 효과적으로 막을 수 있다. 특히 CSRF 토큰을 사용하는 것이 매우 효과적이며, 현대적인 웹 애플리케이션에서 권장되는 방어 기법 중 하나다.

XSS(Cross-Site Scripting)는 웹 애플리케이션에서 발생하는 보안 취약점 중 하나로, 공격자가 악의적인 스크립트를 웹 페이지에 삽입하여 사용자의 브라우저에서 실행되도록 하는 공격이다. 이를 통해 공격자는 사용자의 정보를 탈취하거나 세션을 훔치는 등의 악의적인 행위를 수행할 수 있다.

XSS 공격의 주요 유형은 다음과 같다:

1. **Stored XSS (저장형 XSS):** 악성 스크립트가 서버에 저장되어, 해당 스크립트가 클라이언트에게 전달되고 실행되는 경우이다. 주로 게시글이나 댓글 등에 악성 스크립트가 저장되어 공격된다.

2. **Reflected XSS (반사형 XSS):** 악성 스크립트가 사용자에게 직접 주입되어 실행되는 경우이다. 주로 피싱 사이트에서 많이 발생한다.

3. **DOM-based XSS (DOM 기반 XSS):** 악성 스크립트가 클라이언트 측에서 동적으로 DOM(Document Object Model)을 조작하여 발생하는 경우이다.

XSS 공격을 방지하기 위한 주요 방법은 다음과 같다:

1. **입력 데이터의 검증 및 이스케이프:**
    
    사용자 입력을 받을 때, 해당 입력을 검증하고 필요한 경우 특수 문자를 이스케이프하여 사용한다. 이를 통해 입력 데이터가 스크립트로 해석되는 것을 방지할 수 있다.

2. **콘텐츠 보안 정책 설정:**
    
    Content Security Policy (CSP)를 사용하여 허용된 리소스 및 스크립트 실행 정책을 명시적으로 설정한다. 이를 통해 악성 스크립트의 실행을 방지할 수 있다.

3. **HttpOnly 속성 사용:**
    
    쿠키에 HttpOnly 속성을 추가하여, 자바스크립트에서 쿠키에 접근하는 것을 방지한다. 이를 통해 세션 쿠키가 XSS에 의해 탈취되는 것을 막을 수 있다.

4. **웹 어플리케이션 방화벽 (WAF) 사용:**
    
    웹 어플리케이션 방화벽을 도입하여 악성 코드나 공격 시도를 탐지하고 차단할 수 있다.

5. **보안 헤더 사용:**
    
    보안 관련 헤더를 설정하여 XSS 등의 보안 공격에 대비할 수 있다. `X-Content-Type-Options`, `X-Frame-Options`, `X-XSS-Protection` 등이 있다.